!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("Shiny"),require("jQuery")):"function"==typeof define&&define.amd?define(["Shiny","jQuery"],t):"object"==typeof exports?exports.waiter=t(require("Shiny"),require("jQuery")):e.waiter=t(e.Shiny,e.jQuery)}(self,(function(e,t){return(()=>{"use strict";var n={541:t=>{t.exports=e},609:e=>{e.exports=t}},o={};function r(e){var t=o[e];if(void 0!==t)return t.exports;var i=o[e]={exports:{}};return n[e](i,i.exports,r),i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{r.r(i),r.d(i,{showWaiter:()=>a,hideWaiter:()=>l,updateWaiter:()=>s,showRecalculate:()=>c}),r(541),r(609);var e=new Map,t=new Map,n=new Map,o=new Map;const a=(r=null,i,a="#333e48",l=!1,s=!1,d=!1,c=null,h=!1)=>{if(null==i)return void console.error("Missing html content");var y,f="body",p=!1;if(null!==r&&(f="#"+r),null==(y=document.querySelector(f)))return void console.log("Cannot find",r);l=l||!1,e.set(r,l),t.set(f,h),n.set(r,s),o.set(r,d);let w={width:(m=y).offsetWidth,height:m.offsetHeight,top:isNaN(m.offsetTop)?0:m.offsetTop,left:isNaN(m.offsetLeft)?0:m.offsetLeft};var m;if(null===r&&(w.height=window.innerHeight,w.width=$("body").width()),"relative"==window.getComputedStyle(y,null).position&&(y.className+=" staticParent"),y.childNodes.forEach((function(e){"waiter-overlay"===e.className&&(p=!0)})),!0!==p){u(r);var g=document.createElement("DIV"),v=document.createElement("DIV");v.innerHTML=i,v.classList.add("waiter-overlay-content"),g.style.position=null==r?"fixed":"absolute",g.style.height=w.height+"px",g.style.width=w.width+"px",g.style.top=w.top+"px",g.style.left=w.left+"px",g.style.backgroundColor=a,g.classList.add("waiter-overlay"),null!=c&&""!=c&&(g.style.backgroundImage="url('"+c+"')"),null!==r?g.classList.add("waiter-local"):g.classList.add("waiter-fullscreen"),g.appendChild(v),y.appendChild(g);try{Shiny.setInputValue(r+"_waiter_shown",!0,{priority:"event"})}catch(e){console.log("waiterShowOnLoad - shiny not connected yet:",e.message)}}else console.log("waiter on",r,"already exists")},l=e=>{var n="body";null!==e&&(n="#"+e);let o=$(n).find(".waiter-overlay");if(0==o.length)return;let r=250;if(t.get(n)){let e=t.get(n);"boolean"==typeof e&&(e=500),$(o).fadeOut(e),r+=e}setTimeout((function(){o.remove()}),r)},s=(e,t)=>{var n="body";null!==e&&(n="#"+e);var o=document.querySelector(n).getElementsByClassName("waiter-overlay-content");0!=o.length&&(o.length>0?o[0].innerHTML=t:console.log("no waiter on",e))};let d=new Map;const u=e=>{if(null!==e&&!d.get(e)){d.set(e,!0);var t="#"+e+".recalculating {opacity: 1.0 !important; }",n=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.id=e+"-waiter-recalculating",o.styleSheet?o.styleSheet.cssText=t:o.appendChild(document.createTextNode(t)),n.appendChild(o)}},c=e=>{$(e+"-waiter-recalculating").remove()};$(document).on("shiny:value",(function(t){e.get(t.name)&&l(t.name)})),$(document).on("shiny:error",(function(e){(null==e.error.type&&n.get(e.name)||null!=e.error.type&&o.get(e.name))&&l(e.name)})),window.addEventListener("resize",(function(){let e=document.getElementsByClassName("waiter-local"),t=document.getElementsByClassName("waiter-fullscreen");for(waiter of e)dim=get_offset(waiter.parentElement),waiter.style.width=dim.width+"px",waiter.style.height=dim.height+"px";for(waiter of t)dim=get_offset(waiter.parentElement),waiter.style.width=window.innerWidth+"px",waiter.style.height=window.innerHeight+"px"})),Shiny.addCustomMessageHandler("waiter-show",(function(e){a(e.id,e.html,e.color,e.hide_on_render,e.hide_on_error,e.hide_on_silent_error,e.image,e.fade_out),Shiny.setInputValue("waiter_shown",!0,{priority:"event"})})),Shiny.addCustomMessageHandler("waiter-update",(function(e){s(e.id,e.html)})),Shiny.addCustomMessageHandler("waiter-hide",(function(e){l(e.id);let t="waiter_hidden";null!==e.id&&(t=e.id+"_"+t),Shiny.setInputValue(t,!0,{priority:"event"})}))})(),i})()}));
//# sourceMappingURL=waiter.js.map