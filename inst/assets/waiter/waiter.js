!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("Shiny"),require("jQuery")):"function"==typeof define&&define.amd?define(["Shiny","jQuery"],t):"object"==typeof exports?exports.waiter=t(require("Shiny"),require("jQuery")):e.waiter=t(e.Shiny,e.jQuery)}(self,(function(e,t){return(()=>{"use strict";var n={541:t=>{t.exports=e},609:e=>{e.exports=t}},i={};function r(e){var t=i[e];if(void 0!==t)return t.exports;var o=i[e]={exports:{}};return n[e](o,o.exports,r),o.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return(()=>{r.r(o),r.d(o,{hideWaiter:()=>u,showRecalculate:()=>p,showWaiter:()=>s,updateWaiter:()=>c}),r(541),r(609);const e=e=>({width:e.offsetWidth,height:e.offsetHeight,top:isNaN(e.offsetTop)?0:e.offsetTop,left:isNaN(e.offsetLeft)?0:e.offsetLeft});var t=new Map,n=new Map,i=new Map,l=new Map;const a=e=>{let t="waiter_hidden";null!==e&&(t=e+"_"+t),Shiny.setInputValue(t,!0,{priority:"event"})};let d={id:null,html:'<div class="container--box"><div class="boxxy"><div class="spinner spinner--1"></div></div></div>',color:"#333e48",hideOnRender:!1,hideOnError:!1,hideOnSilentError:!1,image:null,fadeOut:!1,onShown:e=>{let t="waiter_shown";null!==e&&(t=e+"_"+t),Shiny.setInputValue(t,!0,{priority:"event"})}};const s=(r=d)=>{var o,a="body",s=!1;if(null!==r.id&&(a="#"+r.id),null==(o=document.querySelector(a)))return void console.log("Cannot find",r.id);r.hideOnRender=r.hideOnRender||!1,t.set(r.id,r.hideOnError),n.set(a,r.fadeOut),i.set(r.id,r.hideOnError),l.set(r.id,r.hideOnSilentError);let u=e(o);if(null===r.id&&(u.height=window.innerHeight,u.width=$("body").width()),"relative"==window.getComputedStyle(o,null).position&&(o.className+=" staticParent"),o.childNodes.forEach((function(e){"waiter-overlay"===e.className&&(s=!0)})),s)return void console.log("waiter on",r.id,"already exists");y(r.id);let c=document.createElement("DIV"),h=document.createElement("DIV");h.innerHTML=r.html,h.classList.add("waiter-overlay-content"),null==r.id?c.style.position="fixed":c.style.position="absolute",c.style.height=u.height+"px",c.style.width=u.width+"px",c.style.top=u.top+"px",c.style.left=u.left+"px",c.style.backgroundColor=r.color,c.classList.add("waiter-overlay"),null!=r.image&&""!=r.image&&(c.style.backgroundImage="url('"+r.image+"')"),null!==r.id?c.classList.add("waiter-local"):c.classList.add("waiter-fullscreen"),c.appendChild(h),o.appendChild(c);try{r.onShown(r.id)}catch(e){console.log("likely using waiterShowOnLoad - shiny not connected yet:",e.message)}},u=(e,t)=>{var i="body";null!==e&&(i="#"+e);let r=$(i).find(".waiter-overlay");if(0==r.length)return;let o=250;if(n.get(i)){let e=n.get(i);"boolean"==typeof e&&(e=500),$(r).fadeOut(e),o+=e}setTimeout((function(){r.remove()}),o),t(e)},c=(e,t)=>{var n="body";null!==e&&(n="#"+e);var i=document.querySelector(n).getElementsByClassName("waiter-overlay-content");0!=i.length&&(i.length>0?i[0].innerHTML=t:console.log("no waiter on",e))};let h=new Map;const y=e=>{if(null!==e&&!h.get(e)){h.set(e,!0);var t="#"+e+".recalculating {opacity: 1.0 !important; }",n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.id=e+"-waiter-recalculating",i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t)),n.appendChild(i)}},p=e=>{$(e+"-waiter-recalculating").remove()};$(document).on("shiny:value",(function(e){waiterToHide.get(e.name)&&u(e.name)})),$(document).on("shiny:error",(function(e){(null==e.error.type&&i.get(e.name)||null!=e.error.type&&l.get(e.name))&&u(e.name)})),window.addEventListener("resize",(function(){let t=document.getElementsByClassName("waiter-local"),n=document.getElementsByClassName("waiter-fullscreen");for(waiter of t){let t=e(waiter.parentElement);waiter.style.width=t.width+"px",waiter.style.height=t.height+"px"}for(waiter of n)waiter.style.width=window.innerWidth+"px",waiter.style.height=window.innerHeight+"px"})),Shiny.addCustomMessageHandler("waiter-show",(function(e){s({id:e.id,html:e.html,color:e.color,hideOnRender:e.hide_on_render,hideOnError:e.hide_on_error,hideOnSilentError:e.hide_on_silent_error,image:e.image,fadeOut:e.fade_out}),Shiny.setInputValue("waiter_shown",!0,{priority:"event"})})),Shiny.addCustomMessageHandler("waiter-update",(function(e){c(e.id,e.html)})),Shiny.addCustomMessageHandler("waiter-hide",(function(e){u(e.id,a)}))})(),o})()}));
//# sourceMappingURL=waiter.js.map